<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<h1>Askerval</h1>

<button id="rate-view-btn">Rate</button>
<button id="history-view-btn">History</button>

<div id="rate-view">
    <h2>What's your mood?</h2>
    <div class="mood-rating">
        <span>bad</span>

        <input type="radio" name="mood" id="1_mood" value="1">
        <label for="1_mood">1</label>

        <input type="radio" name="mood" id="2_mood" value="2">
        <label for="2_mood">2</label>

        <input type="radio" name="mood" id="3_mood" value="3">
        <label for="3_mood">3</label>

        <input type="radio" name="mood" id="4_mood" value="4">
        <label for="4_mood">4</label>

        <input type="radio" name="mood" id="5_mood" value="5">
        <label for="5_mood">5</label>

        <span>good</span>
    </div>
</div>




<div id="history-view" style="display: none;">
    <h2>Moods</h2>
    <ul id="prev-moods"></ul>
</div>

<script>
    const electron = require('electron');
    const {ipcRenderer} = electron;

    const updateMoodList = (moods) => {
        const prevMoodsEl = document.querySelector('#prev-moods');
        prevMoodsEl.innerHTML = '';

        moods.forEach(mood => {
            const moodLi = document.createElement('li');
            const text = document.createTextNode(`${mood.date}: ${mood.rating}`);

            moodLi.appendChild(text);
            prevMoodsEl.appendChild(moodLi);
        })
    };

    const switchToRateView = function () {
        document.querySelector('#rate-view').style.display = 'block';
        document.querySelector('#history-view').style.display = 'none';
    };

    const switchToHistoryView = () => {
        document.querySelector('#rate-view').style.display = 'none';
        document.querySelector('#history-view').style.display = 'block';
    };

    document.querySelectorAll('input[name=mood]').forEach(e => e.addEventListener('click', (evt) => {
        const rating = evt.target.value;
        ipcRenderer.send('rating', rating);
    }));

    document.querySelector('#rate-view-btn').addEventListener('click', () => {
        switchToRateView();
    });

    document.querySelector('#history-view-btn').addEventListener('click', () => {
        requestMoodHistory();
        switchToHistoryView();
    });


    const requestMoodHistory = () => {
        ipcRenderer.send('mood:load-all');
    };

    ipcRenderer.on('mood:list', (evt, moods) => {
        updateMoodList(moods);
    });

</script>

</body>
</html>